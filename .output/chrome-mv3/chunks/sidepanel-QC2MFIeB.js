import{c as f,r,j as e,K as ge,E as Se,b as fe,d as we,C as Ee,S as ye,Q as _,h as ee,i as $e,k as B,A as le,l as Te,m as me,a as Ae,M as ze,T as ne,G as ue,n as X,e as Me,D as he,o as Ie,p as ie,q as se,s as Pe,t as H,u as be,w as _e,x as Fe,g as Oe,y as Re,z as qe,B as J,R as Le,f as Ge}from"./client-YTx1CnKY.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],de=f("book-marked",Ke);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],je=f("chevron-down",Ue);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Qe=f("chevron-left",De);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],He=f("chevron-right",Ve);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],We=f("clock",Be);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],ce=f("cpu",Ze);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],ve=f("download",Ye);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Je=f("file-text",Xe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],tt=f("folder-plus",et);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],at=f("folder",st);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ae=f("info",lt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],xe=f("loader-circle",it);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],nt=f("maximize-2",ot);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],dt=f("panel-left",rt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}]],pt=f("panel-right",ct);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],ut=f("pause",mt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],bt=f("pencil",ht);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],gt=f("play",xt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],wt=f("plus",ft);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],jt=f("settings",yt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],oe=f("trash-2",vt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],kt=f("trending-up",Nt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],St=f("type",Ct);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],pe=f("upload",Et);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],re=f("wand-sparkles",$t);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Q=f("x",Tt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],zt=f("zap",At),Mt=({isOpen:t,isDark:s,currentKey:i,onClose:w,onSave:p})=>{const[E,N]=r.useState(i||""),[y,$]=r.useState(!1),C=()=>{E.trim()&&(p(E.trim()),w())};return t?e.jsx("div",{className:"fixed inset-0 z-[1200] flex items-center justify-center bg-black/80 backdrop-blur-md p-2",children:e.jsxs("div",{className:`max-w-md w-full p-2 rounded-md border shadow-2xl ${s?"glass-panel border-white/10":"bg-white border-slate-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{size:18,className:"text-blue-500"}),e.jsx("h2",{className:"text-sm font-black",children:"API Key Configuration"})]}),e.jsx("button",{onClick:w,className:"p-1 hover:bg-white/5 rounded-md transition-all",children:e.jsx(Q,{size:18})})]}),e.jsxs("div",{className:"p-2 space-y-3",children:[e.jsxs("div",{className:`p-2 rounded-md border text-[10px] leading-tight ${s?"bg-white/5 border-white/5 opacity-70":"bg-slate-50 border-slate-100"}`,children:[e.jsx("p",{className:"mb-2",children:"Get your Gemini API key from Google AI Studio. Your key is stored locally and never sent to external servers."}),e.jsxs("a",{href:"https://aistudio.google.com/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline flex items-center gap-1",children:["Get API Key ",e.jsx(Se,{size:10})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-black uppercase opacity-40 ml-1",children:"Gemini API Key"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:y?"text":"password",value:E,onChange:z=>N(z.target.value),placeholder:"AIzaSy...",className:`w-full p-2 pr-10 rounded-md outline-none border font-mono text-xs ${s?"bg-black/40 border-white/10":"bg-slate-50 border-slate-200"}`}),e.jsx("button",{type:"button",onClick:()=>$(!y),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 opacity-40 hover:opacity-100",children:y?e.jsx(fe,{size:14}):e.jsx(we,{size:14})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:w,className:`flex-1 p-2 rounded-md font-black text-xs border ${s?"bg-white/5 border-white/10":"bg-white border-slate-200"}`,children:"Cancel"}),e.jsx("button",{onClick:C,disabled:!E.trim(),className:"flex-1 p-2 bg-blue-600 hover:bg-blue-500 text-white rounded-md font-black text-xs shadow-lg disabled:opacity-50",children:"Save Key"})]})]})]})}):null},It=({isOpen:t,isDark:s,onClose:i,onUpload:w})=>{const p=r.useRef(null),E=()=>{const y=`Prompt,Template Modifier
A cyberpunk city,hyper-realistic 8k resolution
A majestic dragon,anime studio ghibli style
A cozy cabin,winter forest background`,$=new Blob([y],{type:"text/csv;charset=utf-8;"}),C=document.createElement("a"),z=URL.createObjectURL($);C.setAttribute("href",z),C.setAttribute("download","nano_flow_template.csv"),C.style.visibility="hidden",document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(z)},N=y=>{var z;const $=(z=y.target.files)==null?void 0:z[0];if(!$)return;const C=new FileReader;C.onload=n=>{var k;const A=((k=n.target)==null?void 0:k.result).split(`
`),S=[];A.forEach(O=>{var c,b;const h=O.split(","),j=(c=h[0])==null?void 0:c.trim(),D=(b=h[1])==null?void 0:b.trim();j&&j.toLowerCase()!=="prompt"&&S.push({prompt:j,modifier:D})}),w(S),i()},C.readAsText($),p.current&&(p.current.value="")};return t?e.jsx("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center bg-black/80 backdrop-blur-md p-2",children:e.jsxs("div",{className:`max-w-md w-full p-2 rounded-md border shadow-2xl ${s?"glass-panel border-white/10":"bg-white border-slate-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{size:18,className:"text-blue-500"}),e.jsx("h2",{className:"text-sm font-black",children:"Import Batch"})]}),e.jsx("button",{onClick:i,className:"p-1 hover:bg-white/5 rounded-md transition-all",children:e.jsx(Q,{size:18})})]}),e.jsxs("div",{className:"p-2 space-y-2",children:[e.jsxs("div",{className:`p-2 rounded-md border text-[10px] leading-tight ${s?"bg-white/5 border-white/5 opacity-70":"bg-slate-50 border-slate-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-1 font-black uppercase tracking-widest mb-1",children:[e.jsx(ae,{size:10})," CSV Guide"]}),"Format: Prompt, Modifiers (Optional)."]}),e.jsxs("button",{onClick:E,className:`w-full p-2 rounded-md font-black text-xs flex items-center justify-center gap-2 border ${s?"bg-white/5 border-white/10":"bg-white border-slate-200"}`,children:[e.jsx(ve,{size:16})," Get Template"]}),e.jsxs("button",{onClick:()=>{var y;return(y=p.current)==null?void 0:y.click()},className:"w-full p-2 bg-blue-600 hover:bg-blue-500 text-white rounded-md font-black text-xs flex items-center justify-center gap-2 shadow-lg",children:[e.jsx(pe,{size:16})," Upload CSV"]}),e.jsx("input",{ref:p,type:"file",accept:".csv",className:"hidden",onChange:N})]})]})}):null},Pt=({onComplete:t,isDark:s})=>{const[i,w]=r.useState(0),p=[{title:"Welcome to Nano Flow",description:"A high-performance bulk image generation engine designed to unlock Gemini's creative potential at scale.",icon:e.jsx(ye,{className:"text-blue-500",size:40})},{title:"The Queue Engine",description:"Paste dozens of prompts or upload a CSV. Use the selection toolbar to weight specific words for the AI.",icon:e.jsx(ce,{className:"text-amber-500",size:40})},{title:"Style Library",description:"Manage custom modifiers, instructions, and reference assets in folders. Apply them to your queue in one click.",icon:e.jsx(de,{className:"text-emerald-500",size:40})},{title:"AI Prompt Optimization",description:"Use the magic wand icons to let Gemini analyze and improve your library prompts automatically for better results.",icon:e.jsx(re,{className:"text-amber-400",size:40})},{title:"Flash vs Pro",description:"Toggle between ultra-fast Flash 2.0 and high-fidelity Imagen 3 models in your application settings.",icon:e.jsx(zt,{className:"text-purple-500",size:40})}];return e.jsx("div",{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/80 backdrop-blur-md p-2",children:e.jsx("div",{className:`max-w-md w-full p-6 rounded-md border shadow-2xl animate-in fade-in zoom-in-95 duration-300 ${s?"glass-panel border-white/10":"bg-white border-slate-200"}`,children:e.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white/5 rounded-md shadow-inner border border-white/5 mb-2",children:p[i].icon}),e.jsx("h2",{className:"text-xl font-black tracking-tight",children:p[i].title}),e.jsx("p",{className:"text-sm opacity-60 leading-relaxed font-medium min-h-[60px]",children:p[i].description}),e.jsx("div",{className:"flex gap-1 mb-4",children:p.map((E,N)=>e.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition-all duration-300 ${i===N?"bg-blue-500 w-4":"bg-white/10"}`},N))}),e.jsxs("div",{className:"w-full flex gap-2",children:[i>0?e.jsxs("button",{onClick:()=>w(E=>E-1),className:"flex-1 p-2 rounded-md border border-white/10 text-[10px] font-black uppercase tracking-widest hover:bg-white/5 transition-all flex items-center justify-center gap-2",children:[e.jsx(Qe,{size:14})," Back"]}):e.jsx("button",{onClick:t,className:"flex-1 p-2 rounded-md border border-white/10 text-[10px] font-black uppercase opacity-40 hover:opacity-100 transition-all",children:"Skip"}),i<p.length-1?e.jsxs("button",{onClick:()=>w(E=>E+1),className:"flex-[2] p-2 bg-blue-600 hover:bg-blue-500 text-white rounded-md font-black text-[10px] uppercase tracking-widest shadow-lg shadow-blue-600/20 flex items-center justify-center gap-2",children:["Next ",e.jsx(He,{size:14})]}):e.jsxs("button",{onClick:t,className:"flex-[2] p-2 bg-emerald-600 hover:bg-emerald-500 text-white rounded-md font-black text-[10px] uppercase tracking-widest shadow-lg shadow-emerald-600/20 flex items-center justify-center gap-2",children:["Get Started ",e.jsx(Ee,{size:14})]})]})]})})})},_t={[_.IDLE]:"bg-gray-500/20 text-gray-400",[_.PROCESSING]:"bg-blue-500/20 text-blue-400 animate-pulse",[_.COMPLETED]:"bg-emerald-500/20 text-emerald-400",[_.FAILED]:"bg-red-500/20 text-red-400",[_.PAUSED]:"bg-amber-500/20 text-amber-400"},Ft={[_.IDLE]:"Waiting in queue to be processed",[_.PROCESSING]:"Currently being generated by Gemini",[_.COMPLETED]:"Successfully completed",[_.FAILED]:"Generation failed - check Gemini for errors",[_.PAUSED]:"Paused - will resume when queue starts"},Ot=({status:t})=>e.jsx("div",{title:Ft[t],className:`px-2 py-0.5 rounded-md text-[9px] font-black uppercase tracking-widest flex items-center gap-1 cursor-help ${_t[t]}`,children:t}),Rt=({text:t})=>e.jsx("span",{title:t,className:"inline-flex items-center cursor-help opacity-30 hover:opacity-70 transition-opacity ml-1",children:e.jsx(ae,{size:10})}),qt=({queue:t,isDark:s,defaultTool:i,onAddToQueue:w,onRemoveFromQueue:p,onOpenCsvDialog:E})=>{const[N,y]=r.useState(""),[$,C]=r.useState([]),[z,n]=r.useState(null),[g,A]=r.useState(i||ee.IMAGE),S=r.useRef(null),k=r.useRef(null),O=()=>{if(S.current){const c=S.current.selectionStart,b=S.current.selectionEnd,F=S.current.value.substring(c,b);F.trim().length>0?n({start:c,end:b,text:F}):n(null)}},h=c=>{if(!z||!S.current)return;const{start:b,end:F,text:M}=z,G=S.current.value;let R="";switch(c){case"standard":R=`(${M}:1.2)`;break;case"heavy":R=`((${M}:1.5))`;break;case"ultra":R=`(((${M}:1.8)))`;break;case"echo":R=`${M}... ${M}`;break}const K=G.substring(0,b)+R+G.substring(F);y(K),n(null),S.current.focus()},j=c=>{Array.from(c.target.files||[]).forEach(F=>{const M=new FileReader;M.onload=G=>{var K;const R=(K=G.target)==null?void 0:K.result;C(te=>[...te,R])},M.readAsDataURL(F)}),c.target.value=""},D=()=>{w(N,void 0,$,g),y(""),C([])};return e.jsxs("div",{className:"space-y-2 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsxs("span",{className:"text-[9px] font-black uppercase tracking-widest opacity-40 flex items-center",children:["New Prompt",e.jsx(Rt,{text:"Enter your image description. Use line breaks to create multiple prompts at once."})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{var c;return(c=k.current)==null?void 0:c.click()},title:"Attach reference images",className:`p-1.5 rounded-md border transition-all ${s?"bg-white/5 border-white/10":"bg-white border-slate-200 shadow-sm"} ${$.length>0?"text-blue-500 bg-blue-500/10 border-blue-500/30":"opacity-40 hover:opacity-100"}`,children:e.jsx($e,{size:14})}),e.jsx("button",{onClick:E,title:"Import prompts from CSV",className:`p-1.5 rounded-md border transition-all ${s?"bg-white/5 border-white/10":"bg-white border-slate-200 shadow-sm"} opacity-40 hover:opacity-100`,children:e.jsx(pe,{size:14})}),e.jsx("input",{ref:k,type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:j})]})]}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:Object.entries(B).filter(([c])=>c!==ee.NONE).map(([c,b])=>e.jsxs("button",{onClick:()=>A(c),title:b.description,className:`px-2 py-1 rounded-md text-[9px] font-bold transition-all flex items-center gap-1 ${g===c?"bg-blue-600 text-white shadow-lg shadow-blue-600/30":s?"bg-white/5 hover:bg-white/10 border border-white/10":"bg-slate-100 hover:bg-slate-200 border border-slate-200"}`,children:[e.jsx("span",{children:b.icon}),e.jsx("span",{className:"hidden sm:inline",children:b.label})]},c))}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{ref:S,value:N,onChange:c=>y(c.target.value),onSelect:O,placeholder:"Enter image instructions...",className:`w-full p-2 text-xs min-h-[140px] rounded-md border outline-none transition-all no-scrollbar leading-relaxed ${s?"bg-black/40 border-white/10 focus:border-blue-500/50":"bg-slate-50 border-slate-200 focus:border-blue-500/50 shadow-inner"}`}),z&&e.jsxs("div",{className:"absolute top-0 right-0 -translate-y-full mb-1 flex gap-1 p-1 bg-blue-600 rounded-md shadow-2xl animate-in fade-in slide-in-from-bottom-1 z-50",children:[e.jsx("button",{onClick:()=>h("standard"),title:"Light emphasis (1.2x)",className:"p-1 hover:bg-white/10 rounded-md",children:e.jsx(St,{size:12})}),e.jsx("button",{onClick:()=>h("heavy"),title:"Strong emphasis (1.5x)",className:"p-1 hover:bg-white/10 rounded-md",children:e.jsx(nt,{size:12})}),e.jsx("button",{onClick:()=>h("echo"),title:"Repeat for impact",className:"p-1 hover:bg-white/10 rounded-md",children:e.jsx(kt,{size:12})}),e.jsx("button",{onClick:()=>n(null),title:"Cancel",className:"p-1 hover:bg-white/10 rounded-md border-l border-white/20",children:e.jsx(Q,{size:12})})]}),$.length>0&&e.jsx("div",{className:"absolute left-1 bottom-1 flex gap-1 p-1 bg-black/60 rounded-md overflow-x-auto max-w-[160px] no-scrollbar",children:$.map((c,b)=>e.jsxs("div",{className:"relative shrink-0",children:[e.jsx("img",{src:c,className:"w-8 h-8 rounded-md object-cover",alt:"ref"}),e.jsx("button",{onClick:()=>C(F=>F.filter((M,G)=>G!==b)),title:"Remove image",className:"absolute -top-1 -right-1 bg-red-600 text-white rounded-md p-0.5",children:e.jsx(Q,{size:6})})]},b))}),e.jsx("button",{onClick:D,title:"Add prompt to processing queue",className:"absolute right-2 bottom-2 bg-blue-600 text-white px-3 py-1 rounded-md text-[10px] font-black uppercase shadow-lg shadow-blue-600/30 active:scale-95 transition-all",children:"Add to Queue"})]}),e.jsx("div",{className:"pt-2 space-y-1",children:t.length===0?e.jsxs("div",{className:"py-12 flex flex-col items-center justify-center opacity-10 gap-2 border-2 border-dashed border-white/5 rounded-md",children:[e.jsx(ce,{size:24}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Queue Empty"})]}):t.map(c=>{const b=c.tool?B[c.tool]:B[ee.IMAGE];return e.jsxs("div",{className:`p-2 rounded-md border group transition-all ${s?"bg-white/2 border-white/5":"bg-white border-slate-100 shadow-sm"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ot,{status:c.status}),e.jsxs("span",{title:(b==null?void 0:b.description)||"Tool",className:`px-1.5 py-0.5 rounded text-[8px] font-bold ${s?"bg-white/10 text-white/60":"bg-slate-100 text-slate-600"}`,children:[b==null?void 0:b.icon," ",b==null?void 0:b.label]})]}),e.jsx("button",{onClick:()=>p(c.id),title:"Remove from queue",className:"opacity-0 group-hover:opacity-100 text-red-500/40 hover:text-red-500 transition-all p-1",children:e.jsx(oe,{size:12})})]}),e.jsxs("p",{className:"text-[10px] font-medium leading-tight line-clamp-2 opacity-80",children:['"',c.originalPrompt,'"']}),c.images&&c.images.length>0&&e.jsx("div",{className:"flex gap-1 mt-2",children:c.images.slice(0,4).map((F,M)=>e.jsx("img",{src:F,className:"w-6 h-6 rounded-md object-cover border border-white/5",alt:"ref"},M))})]},c.id)})})]})},U=({text:t})=>e.jsx("span",{title:t,className:"inline-flex items-center cursor-help opacity-30 hover:opacity-70 transition-opacity ml-1",children:e.jsx(ae,{size:10})}),Lt=({settings:t,isDark:s,onUpdateSettings:i})=>{const[w,p]=r.useState(!1),[E,N]=r.useState({[le.GEMINI]:!1,[le.OPENAI]:!1,[le.ANTHROPIC]:!1}),y=Te(t),$=Object.entries(t.aiApiKeys||{}).filter(([,n])=>n).length,C=n=>{N(g=>({...g,[n]:!g[n]}))},z=(n,g)=>{i({aiApiKeys:{...t.aiApiKeys,[n]:g||void 0}})};return e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsxs("div",{className:`p-2 space-y-2 border rounded-md ${s?"border-white/5 bg-white/2":"border-slate-100 bg-slate-50"}`,children:[e.jsxs("button",{onClick:()=>p(!w),className:"w-full flex items-center justify-between px-1",children:[e.jsxs("label",{className:"text-[9px] font-black uppercase opacity-40 tracking-widest flex items-center cursor-pointer",children:[e.jsx(ge,{size:10,className:"mr-1"}),"AI Providers",e.jsx(U,{text:"Configure API keys for AI-powered features like prompt optimization"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-[9px] font-black uppercase ${y?"text-emerald-500":"text-amber-500"}`,children:y?`${$} Configured`:"Not Set"}),e.jsx(je,{size:14,className:`transition-transform duration-200 ${w?"rotate-180":""}`})]})]}),w&&e.jsxs("div",{className:"space-y-3 pt-2 animate-in slide-in-from-top-1 duration-200",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[9px] font-black uppercase opacity-40 tracking-widest ml-1",children:"Preferred Provider"}),e.jsx("select",{value:t.preferredAIProvider||le.GEMINI,onChange:n=>i({preferredAIProvider:n.target.value}),className:`w-full p-2 rounded-md border text-[10px] font-black uppercase transition-all appearance-none outline-none ${s?"bg-black/40 border-white/10 focus:border-blue-500/50":"bg-white border-slate-200 shadow-sm"}`,children:Object.entries(me).map(([n,g])=>e.jsx("option",{value:n,children:g.label},n))})]}),Object.entries(me).map(([n,g])=>{var O;const A=n,S=((O=t.aiApiKeys)==null?void 0:O[A])||"",k=E[A];return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-[9px] font-black uppercase opacity-40 tracking-widest ml-1 flex items-center gap-1",children:[g.label,S&&e.jsx("span",{className:"text-emerald-500",children:"●"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:k?"text":"password",value:S,onChange:h=>z(A,h.target.value),placeholder:`Enter your ${g.label} API key...`,className:`w-full p-2 pr-10 rounded-md border text-xs outline-none ${s?"bg-black/40 border-white/10 focus:border-blue-500/50":"bg-white border-slate-200"}`}),e.jsx("button",{type:"button",onClick:()=>C(A),className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-40 hover:opacity-100 transition-opacity",title:k?"Hide API key":"Show API key",children:k?e.jsx(fe,{size:14}):e.jsx(we,{size:14})})]}),e.jsx("p",{className:"text-[8px] opacity-30 ml-1",children:g.description})]},n)}),!y&&e.jsx("p",{className:"text-[9px] text-amber-500/80 px-1",children:"Add at least one API key to enable AI prompt optimization"})]})]}),e.jsx("div",{className:`p-2 space-y-2 border rounded-md ${s?"border-white/5 bg-white/2":"border-slate-100 bg-slate-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsxs("label",{className:"text-[9px] font-black uppercase opacity-40 tracking-widest flex items-center",children:["Interface Theme",e.jsx(U,{text:"Switch between dark and light appearance"})]}),e.jsxs("button",{onClick:()=>i({theme:s?ne.LIGHT:ne.DARK}),title:s?"Switch to light mode":"Switch to dark mode",className:`p-2 rounded-md transition-all flex items-center gap-2 text-[10px] font-black uppercase border ${s?"bg-white/5 border-white/10":"bg-slate-100 border-slate-200"}`,children:[s?e.jsx(Ae,{size:12,className:"text-amber-400"}):e.jsx(ze,{size:12,className:"text-blue-500"}),s?"Switch to Light":"Switch to Dark"]})]})}),e.jsxs("div",{className:`p-2 space-y-2 border rounded-md ${s?"border-white/5 bg-white/2":"border-slate-100 bg-slate-50"}`,children:[e.jsxs("label",{className:"text-[9px] font-black uppercase opacity-40 tracking-widest ml-1 flex items-center",children:["Active Synthesis Model",e.jsx(U,{text:"Flash 2.0 is faster, Imagen 3 produces higher quality images"})]}),e.jsxs("select",{value:t.primaryModel,onChange:n=>i({primaryModel:n.target.value}),className:`w-full p-2 rounded-md border text-[10px] font-black uppercase transition-all appearance-none outline-none ${s?"bg-black/40 border-white/10 focus:border-blue-500/50":"bg-white border-slate-200 shadow-sm"}`,children:[e.jsx("option",{value:ue.FLASH,children:"Flash 2.0 (High Speed)"}),e.jsx("option",{value:ue.PRO,children:"Imagen 3 (High Fidelity)"})]})]}),e.jsxs("div",{className:`p-2 space-y-2 border rounded-md ${s?"border-white/5 bg-white/2":"border-slate-100 bg-slate-50"}`,children:[e.jsxs("label",{className:"text-[9px] font-black uppercase opacity-40 tracking-widest ml-1 flex items-center",children:["Default Tool",e.jsx(U,{text:"The Gemini tool to use for new prompts (Image, Video, Canvas, etc.)"})]}),e.jsx("select",{value:t.defaultTool||ee.IMAGE,onChange:n=>i({defaultTool:n.target.value}),className:`w-full p-2 rounded-md border text-[10px] font-black uppercase transition-all appearance-none outline-none ${s?"bg-black/40 border-white/10 focus:border-blue-500/50":"bg-white border-slate-200 shadow-sm"}`,children:Object.entries(B).map(([n,g])=>e.jsxs("option",{value:n,children:[g.icon," ",g.label," - ",g.description]},n))})]}),e.jsxs("div",{className:`p-2 space-y-2 border rounded-md ${s?"border-white/5 bg-white/2":"border-slate-100 bg-slate-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between px-1 mb-2",children:[e.jsx("div",{children:e.jsxs("label",{className:"text-[9px] font-black uppercase opacity-40 tracking-widest flex items-center",children:["Tool Sequence",e.jsx(U,{text:"Cycle through different tools for each prompt (e.g., Image → Video → Canvas → repeat)"})]})}),e.jsx("button",{onClick:()=>i({useToolSequence:!t.useToolSequence}),title:t.useToolSequence?"Disable tool sequence":"Enable tool sequence cycling",className:`w-10 h-5 rounded-full transition-all relative ${t.useToolSequence?"bg-blue-600":"bg-white/10"}`,children:e.jsx("div",{className:`absolute w-4 h-4 rounded-full bg-white top-0.5 transition-all shadow-md ${t.useToolSequence?"left-5":"left-0.5"}`})})]}),e.jsxs("div",{className:`flex flex-wrap gap-1 p-2 rounded-md border min-h-[40px] transition-opacity ${s?"bg-black/40 border-white/10":"bg-white border-slate-200"} ${t.useToolSequence?"":"opacity-40"}`,children:[(t.toolSequence||[]).map((n,g)=>{var A,S;return e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-md text-[10px] font-bold ${s?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-600"}`,children:[e.jsx("span",{children:((A=B[n])==null?void 0:A.icon)||"?"}),e.jsx("span",{children:((S=B[n])==null?void 0:S.label)||n}),t.useToolSequence&&e.jsx("button",{onClick:()=>{const k=[...t.toolSequence||[]];k.splice(g,1),i({toolSequence:k.length>0?k:[ee.IMAGE]})},title:"Remove from sequence",className:"ml-1 opacity-50 hover:opacity-100",children:e.jsx(Q,{size:10})})]},g)}),(t.toolSequence||[]).length===0&&e.jsx("span",{className:"text-[10px] opacity-40",children:"No tools in sequence"})]}),t.useToolSequence&&e.jsx("div",{className:"flex gap-1 flex-wrap",children:Object.entries(B).filter(([n])=>n!==ee.NONE).map(([n,g])=>e.jsx("button",{onClick:()=>{i({toolSequence:[...t.toolSequence||[],n]})},title:`Add ${g.label} to sequence`,className:`px-2 py-1 rounded-md text-[9px] font-bold transition-all ${s?"bg-white/5 hover:bg-white/10 border border-white/10":"bg-slate-100 hover:bg-slate-200"}`,children:g.icon},n))})]}),e.jsxs("div",{className:`p-2 space-y-2 border rounded-md ${s?"border-white/5 bg-white/2":"border-slate-100 bg-slate-50"}`,children:[e.jsxs("label",{className:"text-[9px] font-black uppercase opacity-40 tracking-widest ml-1 flex items-center",children:["Global Prefix",e.jsx(U,{text:"Text automatically added before every prompt (e.g., 'High quality, detailed')"})]}),e.jsx("input",{value:t.prefix,onChange:n=>i({prefix:n.target.value}),placeholder:"Text to prepend to all prompts...",className:`w-full p-2 rounded-md border text-xs outline-none ${s?"bg-black/40 border-white/10":"bg-white border-slate-200"}`})]}),e.jsxs("div",{className:`p-2 space-y-2 border rounded-md ${s?"border-white/5 bg-white/2":"border-slate-100 bg-slate-50"}`,children:[e.jsxs("label",{className:"text-[9px] font-black uppercase opacity-40 tracking-widest ml-1 flex items-center",children:["Global Suffix",e.jsx(U,{text:"Text automatically added after every prompt (e.g., '4K resolution, cinematic')"})]}),e.jsx("input",{value:t.suffix,onChange:n=>i({suffix:n.target.value}),placeholder:"Text to append to all prompts...",className:`w-full p-2 rounded-md border text-xs outline-none ${s?"bg-black/40 border-white/10":"bg-white border-slate-200"}`})]}),e.jsx("div",{className:`p-2 space-y-2 border rounded-md ${s?"border-white/5 bg-white/2":"border-slate-100 bg-slate-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsx("div",{children:e.jsxs("label",{className:"text-[9px] font-black uppercase opacity-40 tracking-widest flex items-center",children:["Sidebar Position",e.jsx(U,{text:"Choose which side of the screen to show the Nano Flow panel"})]})}),e.jsxs("button",{onClick:()=>i({position:t.position===X.LEFT?X.RIGHT:X.LEFT}),title:t.position===X.LEFT?"Move panel to right side":"Move panel to left side",className:`p-2 rounded-md transition-all flex items-center gap-2 text-[10px] font-black uppercase border ${s?"bg-white/5 border-white/10":"bg-slate-100 border-slate-200"}`,children:[t.position===X.LEFT?e.jsx(dt,{size:12,className:"text-blue-500"}):e.jsx(pt,{size:12,className:"text-blue-500"}),t.position===X.LEFT?"Left Side":"Right Side"]})]})}),e.jsxs("div",{className:`p-2 space-y-2 border rounded-md ${s?"border-white/5 bg-white/2":"border-slate-100 bg-slate-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between px-1 mb-2",children:[e.jsx("div",{children:e.jsxs("label",{className:"text-[9px] font-black uppercase opacity-40 tracking-widest flex items-center",children:["Negative Prompts",e.jsx(U,{text:"Elements to avoid in images: blurry, extra fingers, watermarks, etc."})]})}),e.jsx("button",{onClick:()=>i({globalNegativesEnabled:!t.globalNegativesEnabled}),title:t.globalNegativesEnabled?"Disable negative prompts":"Enable negative prompts",className:`w-10 h-5 rounded-full transition-all relative ${t.globalNegativesEnabled?"bg-blue-600":"bg-white/10"}`,children:e.jsx("div",{className:`absolute w-4 h-4 rounded-full bg-white top-0.5 transition-all shadow-md ${t.globalNegativesEnabled?"left-5":"left-0.5"}`})})]}),e.jsx("textarea",{value:t.globalNegatives,onChange:n=>i({globalNegatives:n.target.value}),placeholder:"Things to avoid in all generations...",disabled:!t.globalNegativesEnabled,className:`w-full p-2 rounded-md border text-xs outline-none min-h-[60px] transition-opacity ${s?"bg-black/40 border-white/10":"bg-white border-slate-200"} ${t.globalNegativesEnabled?"":"opacity-40"}`})]}),e.jsx("div",{className:`p-2 space-y-2 border rounded-md ${s?"border-white/5 bg-white/2":"border-slate-100 bg-slate-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsx("div",{children:e.jsxs("label",{className:"text-[9px] font-black uppercase opacity-40 tracking-widest flex items-center",children:["Drip Feed Mode",e.jsx(U,{text:"Adds random delays between prompts to avoid rate limiting"})]})}),e.jsx("button",{onClick:()=>i({dripFeed:!t.dripFeed}),title:t.dripFeed?"Disable random delays":"Enable random delays between prompts",className:`w-10 h-5 rounded-full transition-all relative ${t.dripFeed?"bg-blue-600":"bg-white/10"}`,children:e.jsx("div",{className:`absolute w-4 h-4 rounded-full bg-white top-0.5 transition-all shadow-md ${t.dripFeed?"left-5":"left-0.5"}`})})]})})]})},Gt=({text:t})=>e.jsx("span",{title:t,className:"inline-flex items-center cursor-help opacity-30 hover:opacity-70 transition-opacity ml-1",children:e.jsx(ae,{size:10})}),Kt=({folders:t,isDark:s,hasAIKey:i,onCreateFolder:w,onDeleteFolder:p,onToggleFolder:E,onUseTemplate:N,onDeleteTemplate:y,onSaveTemplate:$,onImproveTemplate:C,onImproveFolder:z})=>{const[n,g]=r.useState(!1),[A,S]=r.useState(""),[k,O]=r.useState(new Set),[h,j]=r.useState(null),D=r.useRef(null),c=()=>{A.trim()&&(w(A.trim()),S(""),g(!1))},b=(o,m)=>{m.stopPropagation(),confirm("Delete folder and all templates inside?")&&p(o)},F=(o,m,v)=>{v.stopPropagation(),confirm("Delete this template?")&&y(o,m)},M=(o,m,v)=>{if(v&&(v.stopPropagation(),v.preventDefault()),m){const I=t.find(q=>q.id===o),T=I==null?void 0:I.templates.find(q=>q.id===m);T&&j({folderId:o,template:{...T}})}else j({folderId:o,template:{id:Math.random().toString(36).substr(2,9),name:"",text:"",createdAt:Date.now(),lastEditedAt:Date.now(),timesUsed:0,images:[]}})},G=()=>{!h||!h.template.name||($(h.folderId,h.template),j(null))},R=async(o,m,v)=>{v.stopPropagation(),O(I=>new Set(I).add(m));try{await C(o,m)}finally{O(I=>{const T=new Set(I);return T.delete(m),T})}},K=async(o,m)=>{m.stopPropagation();const v=t.find(T=>T.id===o);if(!v)return;const I=v.templates.map(T=>T.id);O(T=>new Set([...Array.from(T),...I,o]));try{await z(o)}finally{O(T=>{const q=new Set(T);return I.forEach(W=>q.delete(W)),q.delete(o),q})}},te=o=>{Array.from(o.target.files||[]).forEach(v=>{const I=new FileReader;I.onload=T=>{var W;const q=(W=T.target)==null?void 0:W.result;h&&j(Z=>Z?{...Z,template:{...Z.template,images:[...Z.template.images||[],q]}}:null)},I.readAsDataURL(v)}),o.target.value=""};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsxs("span",{className:"text-[9px] font-black uppercase opacity-40 tracking-widest flex items-center",children:["Collections",e.jsx(Gt,{text:"Organize your favorite prompts into folders. Use AI to improve them!"})]}),e.jsx("button",{onClick:()=>g(!0),title:"Create new folder",className:"p-1.5 rounded-md bg-blue-500/10 text-blue-500 hover:bg-blue-600 hover:text-white transition-all shadow-sm",children:e.jsx(tt,{size:14})})]}),e.jsxs("div",{className:"space-y-2",children:[t.map(o=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("button",{onClick:()=>E(o.id),className:`flex-1 flex items-center gap-2 p-2 rounded-md border text-xs font-black transition-all ${s?"bg-white/5 border-white/5 hover:bg-white/10":"bg-slate-50 border-slate-100 hover:bg-slate-100"}`,children:[e.jsx(at,{size:14,className:"text-blue-500"}),e.jsx("span",{className:"flex-1 text-left",children:o.name}),e.jsx(je,{size:14,className:`transition-transform duration-300 ${o.isOpen?"rotate-180":""}`})]}),e.jsx("button",{onClick:m=>i&&K(o.id,m),disabled:!i||k.has(o.id),title:i?"Improve all prompts in folder":"Configure an AI API key in Settings to enable prompt optimization",className:`p-2 rounded-md transition-all ${i?k.has(o.id)?"bg-amber-500 text-white animate-pulse":"bg-amber-500/10 text-amber-500/60 hover:bg-amber-600 hover:text-white":"bg-white/5 text-white/20 cursor-not-allowed"}`,children:k.has(o.id)?e.jsx(xe,{size:14,className:"animate-spin"}):e.jsx(re,{size:14})}),e.jsx("button",{onClick:m=>b(o.id,m),title:"Delete folder",className:"p-2 rounded-md bg-red-500/10 text-red-500/60 hover:bg-red-600 hover:text-white transition-all",children:e.jsx(oe,{size:14})})]}),o.isOpen&&e.jsxs("div",{className:"space-y-1 mt-1 animate-in slide-in-from-top-1",children:[o.templates.map(m=>e.jsx("div",{className:`group flex flex-col p-2 rounded-md border shadow-sm transition-all ${s?"bg-white/2 border-white/5 hover:border-blue-500/30":"bg-white border-slate-50"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:()=>N(o.id,m.id),children:[e.jsx("p",{className:"text-[10px] font-black text-blue-500 truncate",children:m.name}),e.jsxs("p",{className:"text-[9px] opacity-40 truncate",children:['"',m.text,'"']})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-all",children:[e.jsx("button",{onClick:v=>i&&R(o.id,m.id,v),disabled:!i||k.has(m.id),title:i?"Enhance with AI":"Configure an AI API key in Settings to enable prompt optimization",className:`p-1 rounded-md transition-all ${i?k.has(m.id)?"bg-amber-500 text-white animate-pulse":"hover:bg-amber-500/20 text-amber-500":"text-white/20 cursor-not-allowed"}`,children:k.has(m.id)?e.jsx(xe,{size:12,className:"animate-spin"}):e.jsx(re,{size:12})}),e.jsx("button",{onClick:v=>M(o.id,m.id,v),title:"Edit template",className:"p-1 rounded-md hover:bg-blue-500/20",children:e.jsx(bt,{size:12})}),e.jsx("button",{onClick:v=>F(o.id,m.id,v),title:"Delete template",className:"p-1 rounded-md hover:bg-red-500/20 text-red-500",children:e.jsx(oe,{size:12})}),e.jsx("button",{onClick:()=>N(o.id,m.id),title:"Add to queue",className:"p-1 rounded-md bg-blue-600 text-white shadow-lg",children:e.jsx(wt,{size:12})})]})]})},m.id)),e.jsx("button",{onClick:m=>M(o.id,void 0,m),title:"Create new template",className:"w-full p-2 rounded-md border-2 border-dashed border-white/5 text-[9px] font-black uppercase opacity-20 hover:opacity-100 transition-all",children:"New Style"})]})]},o.id)),t.length===0&&e.jsxs("div",{className:"py-12 flex flex-col items-center justify-center opacity-10 gap-2 border-2 border-dashed border-white/5 rounded-md",children:[e.jsx(de,{size:24}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Library Empty"})]})]})]}),n&&e.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/80 backdrop-blur-md p-2",children:e.jsxs("div",{className:`max-w-md w-full p-2 rounded-md border shadow-2xl ${s?"glass-panel border-white/10":"bg-white border-slate-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-2",children:[e.jsx("h2",{className:"text-sm font-black",children:"New Folder"}),e.jsx("button",{onClick:()=>g(!1),title:"Close",className:"p-1 hover:bg-white/5 rounded-md transition-all",children:e.jsx(Q,{size:18})})]}),e.jsxs("div",{className:"p-2 space-y-2",children:[e.jsx("input",{autoFocus:!0,value:A,onChange:o=>S(o.target.value),onKeyDown:o=>o.key==="Enter"&&c(),placeholder:"Folder Name",className:`w-full p-2 rounded-md outline-none border text-xs font-bold ${s?"bg-black/40 border-white/10":"bg-slate-50 border-slate-200"}`}),e.jsx("button",{onClick:c,className:"w-full p-2 bg-blue-600 hover:bg-blue-500 text-white rounded-md font-black text-xs",children:"Create"})]})]})}),h&&e.jsx("div",{className:"fixed inset-0 z-[900] flex items-center justify-center bg-black/80 backdrop-blur-md p-2",children:e.jsxs("div",{className:`max-w-xl w-full p-2 rounded-md border shadow-2xl ${s?"glass-panel border-white/10":"bg-white border-slate-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-2",children:[e.jsx("h2",{className:"text-sm font-black",children:h.template.createdAt?"Refine Prompt":"New Library Entry"}),e.jsx("button",{onClick:()=>j(null),title:"Close",className:"p-1 hover:bg-white/5 rounded-md",children:e.jsx(Q,{size:18})})]}),e.jsxs("div",{className:"p-2 space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-black uppercase opacity-40 ml-1",children:"Template Title"}),e.jsx("input",{autoFocus:!0,value:h.template.name,onChange:o=>j({...h,template:{...h.template,name:o.target.value}}),placeholder:"e.g. Dreamy Portrait",className:`w-full p-2 rounded-md outline-none border font-bold text-xs ${s?"bg-black/40 border-white/10":"bg-slate-50 border-slate-200"}`})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-black uppercase opacity-40 ml-1",children:"Logic / Modifiers"}),e.jsx("textarea",{value:h.template.text,onChange:o=>j({...h,template:{...h.template,text:o.target.value}}),placeholder:"Add instructions...",className:`w-full p-2 rounded-md outline-none border min-h-[100px] text-xs ${s?"bg-black/40 border-white/10":"bg-slate-50 border-slate-200"}`})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-black uppercase opacity-40 ml-1",children:"Assets"}),e.jsxs("div",{onClick:()=>{var o;return(o=D.current)==null?void 0:o.click()},className:`p-2 rounded-md border-2 border-dashed transition-all cursor-pointer flex flex-wrap gap-1 min-h-[80px] items-center justify-center ${s?"bg-white/5 border-white/10 hover:border-blue-500/50":"bg-slate-50 border-slate-200 hover:border-blue-500/50"}`,children:[e.jsx("input",{ref:D,type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:te}),!h.template.images||h.template.images.length===0?e.jsxs("div",{className:"flex flex-col items-center gap-1 opacity-20",children:[e.jsx(pe,{size:20}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:"Select Files"})]}):h.template.images.map((o,m)=>e.jsxs("div",{className:"relative group/asset",onClick:v=>v.stopPropagation(),children:[e.jsx("img",{src:o,className:"w-12 h-12 rounded-md object-cover border border-white/10 shadow-md",alt:"ref"}),e.jsx("button",{onClick:()=>{var v;return j({...h,template:{...h.template,images:(v=h.template.images)==null?void 0:v.filter((I,T)=>T!==m)}})},title:"Remove image",className:"absolute -top-1.5 -right-1.5 bg-red-600 text-white rounded-md p-1 shadow-lg scale-75 hover:scale-100 transition-transform",children:e.jsx(Q,{size:8})})]},m))]})]}),e.jsxs("button",{onClick:G,title:"Save template",className:"w-full p-2 bg-blue-600 hover:bg-blue-500 text-white rounded-md font-black text-xs flex items-center justify-center gap-2 shadow-lg",children:[e.jsx(Me,{size:14})," Save Template"]})]})]})})]})};function Ut(){const[t,s]=r.useState([]),[i,w]=r.useState([]),[p,E]=r.useState(he),[N,y]=r.useState(!1),[$,C]=r.useState("queue"),[z,n]=r.useState(0),[g,A]=r.useState(!1),[S,k]=r.useState(!1),[O,h]=r.useState(!1),j=p.theme===ne.DARK;r.useEffect(()=>{(async()=>{const[a,d,u,x]=await Promise.all([Fe(),Oe(),Re(),qe()]);s(a),E(d),w(u),A(!x)})()},[]),r.useEffect(()=>Ie(a=>{a[J.QUEUE]&&s(a[J.QUEUE].newValue||[]),a[J.SETTINGS]&&E(a[J.SETTINGS].newValue||he),a[J.FOLDERS]&&w(a[J.FOLDERS].newValue||[])}),[]),r.useEffect(()=>{const l=a=>{a.type===se.PROCESS_QUEUE?y(!0):a.type===se.STOP_PROCESSING?y(!1):a.type===se.UPDATE_QUEUE&&s(a.payload)};return chrome.runtime.onMessage.addListener(l),()=>chrome.runtime.onMessage.removeListener(l)},[]),r.useEffect(()=>{let l;return N?l=setInterval(()=>n(a=>a+100),100):n(0),()=>clearInterval(l)},[N]);const D=async l=>chrome.runtime.sendMessage(l),c=r.useCallback(l=>{var d;let a=`${p.prefix} ${l} ${p.suffix}`.trim();return p.globalNegativesEnabled&&((d=p.globalNegatives)!=null&&d.trim())&&(a+=`. NOT ${p.globalNegatives.trim()}`),a},[p.prefix,p.suffix,p.globalNegatives,p.globalNegativesEnabled]),b=r.useCallback(async(l,a,d,u)=>{const P=(l||"").split(/[,\n]/).map(V=>V.trim()).filter(V=>V!=="").map(V=>{const Ce=a?`${V} ${a}`:V;return{id:Math.random().toString(36).substr(2,9),originalPrompt:V,finalPrompt:c(Ce),status:_.IDLE,tool:u||p.defaultTool,images:d&&d.length>0?[...d]:void 0}}),Y=[...t,...P];s(Y),await ie(Y)},[t,c,p.defaultTool]),F=r.useCallback(async l=>{const a=t.filter(d=>d.id!==l);s(a),await ie(a)},[t]),M=r.useCallback(async()=>{const l=t.filter(a=>a.status!==_.COMPLETED);s(l),await ie(l)},[t]),G=r.useCallback(async l=>{const a=l.map(u=>{const x=u.modifier?`${u.prompt} ${u.modifier}`:u.prompt;return{id:Math.random().toString(36).substr(2,9),originalPrompt:u.prompt,finalPrompt:c(x),status:_.IDLE}}),d=[...t,...a];s(d),await ie(d)},[t,c]),R=r.useCallback(async()=>{N?(await D({type:se.STOP_PROCESSING}),y(!1)):(await D({type:se.PROCESS_QUEUE}),y(!0))},[N]),K=r.useCallback(async l=>{const a={...p,...l};E(a),await Pe(a)},[p]),te=r.useCallback(async l=>{await K({apiKey:l})},[K]),o=r.useCallback(async l=>{const a={id:Math.random().toString(36).substr(2,9),name:l,templates:[],isOpen:!0},d=[...i,a];w(d),await H(d)},[i]),m=r.useCallback(async l=>{const a=i.filter(d=>d.id!==l);w(a),await H(a)},[i]),v=r.useCallback(async l=>{const a=i.map(d=>d.id===l?{...d,isOpen:!d.isOpen}:d);w(a),await H(a)},[i]),I=r.useCallback((l,a)=>{const d=i.find(x=>x.id===l),u=d==null?void 0:d.templates.find(x=>x.id===a);u&&(b(u.text,void 0,u.images),C("queue"))},[i,b]),T=r.useCallback(async(l,a)=>{const d=i.map(u=>u.id===l?{...u,templates:u.templates.filter(x=>x.id!==a)}:u);w(d),await H(d)},[i]),q=r.useCallback(async(l,a)=>{const d=i.map(u=>{if(u.id===l){const x=u.templates.findIndex(P=>P.id===a.id),L={id:a.id||Math.random().toString(36).substr(2,9),name:a.name||"Unnamed",text:a.text||"",createdAt:a.createdAt||Date.now(),lastEditedAt:Date.now(),timesUsed:a.timesUsed||0,images:a.images||[]};if(x>-1){const P=[...u.templates];return P[x]=L,{...u,templates:P}}else return{...u,templates:[...u.templates,L]}}return u});w(d),await H(d)},[i]),W=r.useCallback(async(l,a)=>{const d=i.find(x=>x.id===l),u=d==null?void 0:d.templates.find(x=>x.id===a);if(u){const x=await be(u.text),L=i.map(P=>P.id===l?{...P,templates:P.templates.map(Y=>Y.id===a?{...Y,text:x,lastEditedAt:Date.now()}:Y)}:P);w(L),await H(L)}},[i]),Z=r.useCallback(async l=>{const a=i.find(x=>x.id===l);if(!a)return;const d=await Promise.all(a.templates.map(async x=>{const L=await be(x.text);return{...x,text:L,lastEditedAt:Date.now()}})),u=i.map(x=>x.id===l?{...x,templates:d}:x);w(u),await H(u)},[i]),ke=r.useCallback(async()=>{await _e(!0),A(!1)},[]);return e.jsxs("div",{className:`flex flex-col h-screen w-full overflow-hidden transition-colors duration-500 ${j?"bg-[#0a0a0a] text-white":"bg-[#f8fafc] text-[#1e293b]"}`,children:[g&&e.jsx(Pt,{onComplete:ke,isDark:j}),e.jsx(It,{isOpen:S,isDark:j,onClose:()=>k(!1),onUpload:G}),e.jsx(Mt,{isOpen:O,isDark:j,currentKey:p.apiKey,onClose:()=>h(!1),onSave:te}),e.jsxs("div",{className:`p-2 flex items-center justify-between border-b ${j?"border-white/10 bg-white/5":"border-slate-100 bg-slate-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1 rounded-md bg-blue-600 shadow-lg shadow-blue-600/20",children:e.jsx(ye,{size:16,className:"text-white"})}),e.jsx("h1",{className:"text-sm font-black tracking-tight",children:"Nano Flow"})]}),N&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-blue-500/10 rounded-md border border-blue-500/20",children:[e.jsx(We,{size:10,className:"text-blue-500 animate-spin"}),e.jsxs("span",{className:"text-[10px] font-black text-blue-500",children:[(z/1e3).toFixed(1),"s"]})]})]}),e.jsx("nav",{className:`flex border-b overflow-hidden ${j?"border-white/5 bg-white/2":"border-slate-100"}`,children:[{id:"queue",icon:ce,label:"Queue",tooltip:"Add prompts and process them in batch through Gemini"},{id:"templates",icon:de,label:"Templates",tooltip:"Save your favorite prompts and improve them with AI"},{id:"settings",icon:jt,label:"Settings",tooltip:"Configure API key, prefixes, negatives, and more"}].map(l=>e.jsxs("button",{onClick:()=>C(l.id),className:`flex-1 py-3 text-[8px] font-black uppercase tracking-widest flex flex-col items-center gap-1 transition-all relative group ${$===l.id?"text-blue-500":"opacity-40 hover:opacity-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx(l.icon,{size:14}),e.jsx(ae,{size:8,className:"opacity-0 group-hover:opacity-50 transition-opacity",title:l.tooltip})]}),e.jsx("span",{className:"truncate w-full text-center px-1",children:l.label}),$===l.id&&e.jsx("div",{className:"absolute bottom-0 left-2 right-2 h-0.5 bg-blue-500 rounded-t-md"})]},l.id))}),e.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar p-2",children:[$==="queue"&&e.jsx(qt,{queue:t,isDark:j,defaultTool:p.defaultTool,onAddToQueue:b,onRemoveFromQueue:F,onOpenCsvDialog:()=>k(!0)}),$==="templates"&&e.jsx(Kt,{folders:i,isDark:j,onCreateFolder:o,onDeleteFolder:m,onToggleFolder:v,onUseTemplate:I,onDeleteTemplate:T,onSaveTemplate:q,onImproveTemplate:W,onImproveFolder:Z}),$==="settings"&&e.jsx(Lt,{settings:p,isDark:j,hasApiKey:!!p.apiKey,onUpdateSettings:K,onOpenApiKeyDialog:()=>h(!0)})]}),e.jsxs("div",{className:`p-2 border-t space-y-2 ${j?"bg-black/80 border-white/10 backdrop-blur-xl":"bg-slate-50 border-slate-200"}`,children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:M,title:"Clear completed items",className:"flex-1 p-2 rounded-md border text-[10px] font-black uppercase hover:bg-red-500 hover:text-white transition-all border-white/10",children:e.jsx(oe,{size:14,className:"mx-auto"})}),e.jsxs("button",{onClick:R,disabled:t.length===0,title:N?"Stop processing queue":"Start processing queue",className:`flex-[4] p-2 rounded-md flex items-center justify-center gap-2 text-xs font-black uppercase shadow-xl transition-all active:scale-[0.98] ${N?"bg-amber-500 shadow-amber-500/30":"bg-blue-600 shadow-blue-600/30"} text-white disabled:opacity-30`,children:[N?e.jsx(ut,{size:16,fill:"currentColor"}):e.jsx(gt,{size:16,fill:"currentColor"}),N?"Stop":"Start"]})]}),t.filter(l=>l.status===_.COMPLETED).length>0&&e.jsx("div",{className:"flex gap-1 overflow-x-auto no-scrollbar py-1",children:t.filter(l=>l.status===_.COMPLETED).slice(-5).map(l=>{var d,u,x,L;const a=((u=(d=l.results)==null?void 0:d.flash)==null?void 0:u.url)||((L=(x=l.results)==null?void 0:x.pro)==null?void 0:L.url);return a?e.jsxs("div",{className:"relative group shrink-0",children:[e.jsx("img",{src:a,className:"w-12 h-12 rounded-md object-cover border border-white/10",alt:"Result"}),e.jsx("button",{onClick:()=>{const P=document.createElement("a");P.href=a,P.download=`nano_flow_${l.id}.png`,P.click()},title:"Download image",className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-all flex items-center justify-center rounded-md",children:e.jsx(ve,{size:12,className:"text-white"})})]},l.id):null})})]})]})}const Ne=document.getElementById("root");if(!Ne)throw new Error("Could not find root element to mount to");const Dt=Le.createRoot(Ne);Dt.render(e.jsx(Ge.StrictMode,{children:e.jsx(Ut,{})}));
